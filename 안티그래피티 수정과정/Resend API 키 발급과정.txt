1단계: Resend API 키 발급받기
먼저 이메일을 실제로 보내줄 서비스인 Resend에 가입해야 합니다.

Resend.com에 접속하여 가입합니다.
메인 대시보드에서 API Keys 메뉴로 이동합니다.
Create API Key를 클릭하여 키를 생성하고 복사해 둡니다.
2단계: Supabase CLI로 Edge Function 생성하기
로컬 터미널(PowerShell 등)에서 다음 명령어를 순서대로 입력하여 기능을 생성합니다.

powershell
# 1. Supabase 로그인 (팝업창에서 승인)
npx supabase login
# 2. 새로운 Edge Function 프로젝트 초기화 (이름: send-email)
npx supabase functions new send-email
3단계: Edge Function 코드 작성
supabase/functions/send-email/index.ts 파일이 생성되었을 것입니다. 그 내용을 모두 지우고 아래 코드를 복사해서 붙여넣으세요.

typescript
import { serve } from "https://deno.land/std@0.168.0/http/server.ts"
const RESEND_API_KEY = Deno.env.get('RESEND_API_KEY')
serve(async (req) => {
  // Webhook에서 보내는 데이터 파싱
  const { record } = await req.json()
  // 이메일 내용 구성 (상담 데이터 활용)
  const response = await fetch('https://api.resend.com/emails', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${RESEND_API_KEY}`,
    },
    body: JSON.stringify({
      from: 'onboarding@resend.dev', // Resend 기본 발신 주소
      to: '내이메일@example.com',    // 알림을 받을 본인의 이메일 주소로 변경하세요!
      subject: `[신규 상담 신청] ${record.name}님의 문의가 접수되었습니다.`,
      html: `
        <h2>새로운 상담 신청이 있습니다.</h2>
        <p><strong>이름:</strong> ${record.name}</p>
        <p><strong>이메일:</strong> ${record.email}</p>
        <p><strong>연락처:</strong> ${record.phone}</p>
        <p><strong>내용:</strong> ${record.message}</p>
        <p><strong>신청 시간:</strong> ${record.created_at}</p>
      `,
    }),
  })
  const data = await response.json()
  return new Response(JSON.stringify(data), { headers: { 'Content-Type': 'application/json' } })
})
4단계: 환경 변수 설정 및 배포
복사해둔 API 키를 Supabase 서버에 저장하고 코드를 배포합니다.

powershell
# API 키 설정
npx supabase secrets set RESEND_API_KEY=발급받은_API_키_입력
# Edge Function 배포
npx supabase functions deploy send-email
5단계: Supabase Webhook 설정 (마지막 단계)
이제 데이터가 들어올 때 이 함수가 자동으로 실행되도록 Supabase 대시보드에서 설정합니다.

Supabase Dashboard 접속 -> 해당 프로젝트 선택
왼쪽 메뉴에서 Database -> Webhooks 선택
Create a new webhook 클릭
설정값 입력:
Name: send_inquiry_email
Table: inquiries (상담 신청 테이블)
Events: INSERT 체크
Webhook Service: Supabase Edge Functions 선택
Edge Function: 위에서 만든 send-email 선택
Create Webhook을 눌러 완료합니다.
이제 누군가 상담을 신청하면, 데이터베이스에 저장됨과 동시에 설정하신 이메일로 즉시 알림이 도착할 것입니다! 더 궁금하신 점이 있으면 말씀해 주세요. :)

